#include <stdio.h>

void leak_memory(int fd, int addr, int len, int key1, int key2, int key3, int key4, int key5, int key6){
	if(key1==0xcafebabe && key2==0xdeadbeef){
		if(key3+key4+key5+key6==14){
			write(fd, addr, len);	
		}
	}
}

void main(){
	int eip;
	int n;
	leak_memory(1, &stdout, 4, 0xcafebabe, 0xdeadbeef, 1, 3, 3, 7);	// leak libc
	scanf("%d", &eip);
	((int(*)())eip)(0xdeadbeef);	// hijack control flow!
}

