#!/usr/bin/env python3
# -*- coding: utf-8 -*-
from pwn import *

def do_round(io: tube):
    N, C = re.match(b"N=(\d+) C=(\d+)", io.recvline()).groups()
    N, C = int(N), int(C)

    nums = range(N)
    target = 0

    for i in range(C):
        coins = [n for n in nums if (n >> i) & 1]
        io.sendline(" ".join(map(str, coins)).encode())
        weight = int(io.recvline().strip())

        if weight % 10:
            target |= 1 << i

    io.sendline(str(target).encode())
    io.recvline()


io = connect("127.0.0.1", 9007)
io.recvuntil(b"- Ready? starting in 3 sec... -\n")
io.recvline()

for _ in range(100):
    do_round(io)

io.recvuntil(b'Congrats! get your flag\n')

print("exploit succeeded")
print(io.recvline().decode())
